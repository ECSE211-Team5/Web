\hypertarget{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction}{}\section{ca.\+mcgill.\+ecse211.\+odometer.\+Odometry\+Correction Class Reference}
\label{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction}\index{ca.\+mcgill.\+ecse211.\+odometer.\+Odometry\+Correction@{ca.\+mcgill.\+ecse211.\+odometer.\+Odometry\+Correction}}


Inheritance diagram for ca.\+mcgill.\+ecse211.\+odometer.\+Odometry\+Correction\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=222pt]{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for ca.\+mcgill.\+ecse211.\+odometer.\+Odometry\+Correction\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=222pt]{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction_ad80b45e0bc4bf935494e075edcec739c}{Odometry\+Correction} ()  throws Odometer\+Exceptions 
\item 
void \hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction_aad66a7030ac00f3a9cbe7bc33c25acbf}{run} ()
\item 
void \hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction_a21a351682dc75060d6a5f15ad4775068}{do\+Correction} (double angle)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This class implements correction for the odometry on our robot using a light sensor.

\begin{DoxyAuthor}{Author}
Caspar Cedro 

Percy Chen 

Patrick Erath 

Anssam Ghezala 

Susan Matuszewski 

Kamy Moussavi Kafi 
\end{DoxyAuthor}


Definition at line 20 of file Odometry\+Correction.\+java.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction_ad80b45e0bc4bf935494e075edcec739c}\label{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction_ad80b45e0bc4bf935494e075edcec739c}} 
\index{ca\+::mcgill\+::ecse211\+::odometer\+::\+Odometry\+Correction@{ca\+::mcgill\+::ecse211\+::odometer\+::\+Odometry\+Correction}!Odometry\+Correction@{Odometry\+Correction}}
\index{Odometry\+Correction@{Odometry\+Correction}!ca\+::mcgill\+::ecse211\+::odometer\+::\+Odometry\+Correction@{ca\+::mcgill\+::ecse211\+::odometer\+::\+Odometry\+Correction}}
\subsubsection{\texorpdfstring{Odometry\+Correction()}{OdometryCorrection()}}
{\footnotesize\ttfamily ca.\+mcgill.\+ecse211.\+odometer.\+Odometry\+Correction.\+Odometry\+Correction (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption}) throws \hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer_exceptions}{Odometer\+Exceptions}}

This is the class constructor for the \hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction}{Odometry\+Correction} class.


\begin{DoxyExceptions}{Exceptions}
{\em \hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer_exceptions}{Odometer\+Exceptions}} & \\
\hline
\end{DoxyExceptions}


Definition at line 35 of file Odometry\+Correction.\+java.


\begin{DoxyCode}
35                                                         \{
36     \textcolor{comment}{// Utilize the singleton Odometer object instance for thread safety.}
37     this.odometer = Odometer.\hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer_a99171f11e34dea918fa9dd069d721439}{getOdometer}();
38   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction_ad80b45e0bc4bf935494e075edcec739c_cgraph}
\end{center}
\end{figure}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction_a21a351682dc75060d6a5f15ad4775068}\label{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction_a21a351682dc75060d6a5f15ad4775068}} 
\index{ca\+::mcgill\+::ecse211\+::odometer\+::\+Odometry\+Correction@{ca\+::mcgill\+::ecse211\+::odometer\+::\+Odometry\+Correction}!do\+Correction@{do\+Correction}}
\index{do\+Correction@{do\+Correction}!ca\+::mcgill\+::ecse211\+::odometer\+::\+Odometry\+Correction@{ca\+::mcgill\+::ecse211\+::odometer\+::\+Odometry\+Correction}}
\subsubsection{\texorpdfstring{do\+Correction()}{doCorrection()}}
{\footnotesize\ttfamily void ca.\+mcgill.\+ecse211.\+odometer.\+Odometry\+Correction.\+do\+Correction (\begin{DoxyParamCaption}\item[{double}]{angle }\end{DoxyParamCaption})}

This method corrects our robot\textquotesingle{}s \hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer}{Odometer} readings


\begin{DoxyParams}{Parameters}
{\em angle} & The current angle that the robot is facing \\
\hline
\end{DoxyParams}


Definition at line 95 of file Odometry\+Correction.\+java.


\begin{DoxyCode}
95                                          \{
96     \textcolor{keywordtype}{double}[] position = odometer.\hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer_data_a8f40f0264c68f0cbed4fff1723ae7863}{getXYT}();
97     \textcolor{comment}{// Check that our robot's angle is within certain bounds and correct odometer if required.}
98     \textcolor{keywordflow}{if} (angle < 5 || angle > 355) \{
99       \textcolor{keywordtype}{int} sensorCoor = (int) Math.round(position[1] - SENSOR\_DIS / Game.TILE);
100       odometer.\hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer_data_a82986438cd462e66520bc62bb4bd2b75}{setY}(sensorCoor + SENSOR\_DIS / Game.TILE);
101     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (angle < 185 && angle > 175) \{
102       \textcolor{keywordtype}{int} sensorCoor = (int) Math.round(position[1] + SENSOR\_DIS / Game.TILE);
103       odometer.\hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer_data_a82986438cd462e66520bc62bb4bd2b75}{setY}(sensorCoor - SENSOR\_DIS / Game.TILE);
104     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (angle < 95 && angle > 85) \{
105       \textcolor{keywordtype}{int} sensorCoor = (int) Math.round(position[0] - SENSOR\_DIS / Game.TILE);
106       odometer.\hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer_data_a2911d7215e47f3064defe016b46bfeef}{setX}(sensorCoor + SENSOR\_DIS / Game.TILE);
107     \}
108   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction_a21a351682dc75060d6a5f15ad4775068_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction_aad66a7030ac00f3a9cbe7bc33c25acbf}\label{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction_aad66a7030ac00f3a9cbe7bc33c25acbf}} 
\index{ca\+::mcgill\+::ecse211\+::odometer\+::\+Odometry\+Correction@{ca\+::mcgill\+::ecse211\+::odometer\+::\+Odometry\+Correction}!run@{run}}
\index{run@{run}!ca\+::mcgill\+::ecse211\+::odometer\+::\+Odometry\+Correction@{ca\+::mcgill\+::ecse211\+::odometer\+::\+Odometry\+Correction}}
\subsubsection{\texorpdfstring{run()}{run()}}
{\footnotesize\ttfamily void ca.\+mcgill.\+ecse211.\+odometer.\+Odometry\+Correction.\+run (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

This method is called when this \hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction}{Odometry\+Correction} object instance is started as a thread. Functionality wise it will correct the rotation and position of the robot once a black line is detected.


\begin{DoxyExceptions}{Exceptions}
{\em \hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer_exceptions}{Odometer\+Exceptions}} & \\
\hline
\end{DoxyExceptions}


Definition at line 47 of file Odometry\+Correction.\+java.


\begin{DoxyCode}
47                     \{
48     \textcolor{keywordtype}{long} correctionStart, correctionEnd;
49     \textcolor{keywordtype}{boolean} onTopOfLine = \textcolor{keyword}{false};
50 
51     \textcolor{keywordflow}{while} (\textcolor{keyword}{true}) \{
52       correctionStart = System.currentTimeMillis();
53 
54       \textcolor{comment}{// Fetch the sample at offset 0}
55       myColorSample.fetchSample(sampleColor, 0);
56 
57       \textcolor{comment}{// Check if our light sensor has read a black line and is not already on top of one}
58       \textcolor{keywordflow}{if} (sampleColor[0] < LINE\_COLOR\_THRESHOLD && !onTopOfLine) \{
59 
60         \textcolor{comment}{// New black line detected}
61         Sound.beep();
62         onTopOfLine = \textcolor{keyword}{true};
63 
64         \textcolor{keywordtype}{double} x = odometer.\hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer_data_a8f40f0264c68f0cbed4fff1723ae7863}{getXYT}()[0];
65         \textcolor{keywordtype}{double} y = odometer.\hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer_data_a8f40f0264c68f0cbed4fff1723ae7863}{getXYT}()[1];
66 
67         \textcolor{keywordflow}{if} (Math.abs(x % TILE\_WIDTH) < Math.abs(y % TILE\_WIDTH)) \{
68           odometer.\hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer_data_a2911d7215e47f3064defe016b46bfeef}{setX}(Math.round(x / TILE\_WIDTH) * TILE\_WIDTH);
69         \} \textcolor{keywordflow}{else} \{
70           odometer.\hyperlink{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometer_data_a82986438cd462e66520bc62bb4bd2b75}{setY}(Math.round(y / TILE\_WIDTH) * TILE\_WIDTH);
71         \}
72 
73       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sampleColor[0] > LINE\_COLOR\_THRESHOLD) \{
74         \textcolor{comment}{// No longer on top of line, reset to false}
75         onTopOfLine = \textcolor{keyword}{false};
76       \}
77 
78       \textcolor{comment}{// this ensure the odometry correction occurs only once every period}
79       correctionEnd = System.currentTimeMillis();
80       \textcolor{keywordflow}{if} (correctionEnd - correctionStart < CORRECTION\_PERIOD) \{
81         \textcolor{keywordflow}{try} \{
82           Thread.sleep(CORRECTION\_PERIOD - (correctionEnd - correctionStart));
83         \} \textcolor{keywordflow}{catch} (InterruptedException e) \{
84           \textcolor{comment}{// there is nothing to be done here}
85         \}
86       \}
87     \}
88   \}
\end{DoxyCode}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{classca_1_1mcgill_1_1ecse211_1_1odometer_1_1_odometry_correction_aad66a7030ac00f3a9cbe7bc33c25acbf_cgraph}
\end{center}
\end{figure}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/ccc/\+Final\+Project/src/ca/mcgill/ecse211/odometer/\hyperlink{_odometry_correction_8java}{Odometry\+Correction.\+java}\end{DoxyCompactItemize}
